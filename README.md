# EasyDynamicPrompts

<p align="center">
  <strong>åŠ¨æ€æç¤ºè¯æ„å»ºå™¨ - SillyTavern æ‰©å±•</strong>
</p>

<p align="center">
  ä¸º SillyTavern è®¾è®¡çš„å¼ºå¤§åŠ¨æ€æç¤ºè¯æ„å»ºå·¥å…·ï¼Œæä¾›å˜é‡ç®¡ç†ã€æ¡ä»¶é€»è¾‘ã€æ¨¡æ¿ç³»ç»Ÿå’Œè‡ªåŠ¨é€‚é…åŠŸèƒ½ã€‚<br>
  å˜é‡æ“ä½œè¯­æ³•å‚è€ƒ <strong>Minecraft æŒ‡ä»¤</strong> å’Œ <strong>JSON Patch (RFC 6902)</strong> è®¾è®¡ã€‚
</p>

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

| åŠŸèƒ½ | æè¿° |
|------|------|
| ğŸ¯ **å˜é‡ç®¡ç†** | åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å˜é‡ï¼Œæ”¯æŒåµŒå¥—è·¯å¾„å’Œç±»å‹æ ¡éªŒ |
| ğŸ”€ **æ¡ä»¶é€»è¾‘** | æ”¯æŒ if/elseã€å¾ªç¯ç­‰æ§åˆ¶æµ |
| ğŸ“ **æ¨¡æ¿ç³»ç»Ÿ** | Handlebars é£æ ¼æ¨¡æ¿è¯­æ³•ï¼Œæ”¯æŒåµŒå¥—æ¨¡æ¿ |
| ğŸ”„ **è‡ªåŠ¨æ›´æ–°** | è§£æ AI å›å¤ä¸­çš„å˜é‡æ›´æ–°å‘½ä»¤ |
| ğŸ“Š **å˜åŒ–è¿½è¸ª** | è®°å½•å˜é‡å˜åŒ–å†å²ï¼Œæ”¯æŒ display_data å’Œ delta_data |
| ğŸ“¦ **å¯¼å…¥å¯¼å‡º** | æ”¯æŒ JSON æ ¼å¼é…ç½®å¯¼å…¥å¯¼å‡º |
| âš¡ **æ‰¹é‡åŸå­æ“ä½œ** | æ”¯æŒå¤šæ“ä½œåŸå­æ‰§è¡Œå’Œå›æ»š |
| ğŸ§® **å˜é‡é—´è¿ç®—** | æ”¯æŒå˜é‡ä¹‹é—´çš„æ•°å­¦è¿ç®— |

## ğŸ“¥ å®‰è£…

å°†æœ¬æ‰©å±•æ–‡ä»¶å¤¹æ”¾å…¥ SillyTavern çš„ç¬¬ä¸‰æ–¹æ‰©å±•ç›®å½•ï¼š

```
SillyTavern/public/scripts/extensions/third-party/EasyDynamicPrompts/
```

æˆ–é€šè¿‡ Git å…‹éš†ï¼š

```bash
cd SillyTavern/public/scripts/extensions/third-party/
git clone https://github.com/LucNocturne/EasyDynamicPrompts.git
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. åœ¨ SillyTavern ä¸­å¯ç”¨æ‰©å±•
2. åœ¨è®¾ç½®é¢æ¿æ‰¾åˆ° **EasyDynamicPrompts** éƒ¨åˆ†
3. ç‚¹å‡» **"æ‰“å¼€ç¼–è¾‘å™¨"** æŒ‰é’®
4. åˆ›å»ºæˆ–ç¼–è¾‘æ¨¡æ¿
5. ä¿å­˜å¹¶åº”ç”¨

## ğŸ“– å˜é‡æ›´æ–°è¯­æ³•

### ä¸»è¦æ ¼å¼ï¼š`/data` å‘½ä»¤

AI å¯ä»¥åœ¨å›å¤ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ–°å˜é‡ï¼š

```bash
# è®¾ç½®å˜é‡
/data set è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦ 50

# è®¾ç½®å˜é‡ï¼ˆå¸¦æ—§å€¼æ ¡éªŒï¼‰
/data set è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦ 55 test 50

# æ•°å€¼å¢å‡
/data add è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦ 5
/data add è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦ -3

# å‘æ•°ç»„æ·»åŠ å…ƒç´ 
/data push èƒŒåŒ… "æ²»ç–—è¯æ°´"
/data insert èƒŒåŒ… 0 "é‡è¦ç‰©å“"

# åˆ é™¤å˜é‡
/data remove ä¸´æ—¶æ ‡è®°
/data remove èƒŒåŒ….0

# ç§»åŠ¨/å¤åˆ¶å˜é‡
/data move ä¸´æ—¶.ç‰©å“ èƒŒåŒ…/-
/data copy æ¨¡æ¿.æŠ€èƒ½ è§’è‰².æŠ€èƒ½

# å˜é‡é—´è¿ç®—
/data calc æ€»ä¼¤å®³ "åŸºç¡€ä¼¤å®³ + è£…å¤‡åŠ æˆ"

# æ•°ç»„/å¯¹è±¡ä¿®æ”¹
/data modify èƒŒåŒ… append "æ–°ç‰©å“"
/data modify èƒŒåŒ… merge ["ç‰©å“1", "ç‰©å“2"]
/data modify è§’è‰².å±æ€§ merge {"åŠ›é‡": 10}

# æ¡ä»¶æµ‹è¯•
/data test è§’è‰².HP gte 0
/data test è§’è‰².çŠ¶æ€ eq "æ­£å¸¸"
/data test è§’è‰².buff exists
```

### å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | æ ¼å¼ | è¯´æ˜ |
|------|------|------|
| `set` | `/data set <path> <value> [test <old>]` | è®¾ç½®å€¼ |
| `add` | `/data add <path> <delta>` | æ•°å€¼å¢å‡ |
| `push` | `/data push <path> <value>` | æ•°ç»„å°¾éƒ¨è¿½åŠ  |
| `insert` | `/data insert <path> <index> <value>` | æŒ‡å®šä½ç½®æ’å…¥ |
| `remove` | `/data remove <path>` | åˆ é™¤å€¼ |
| `move` | `/data move <from> <to>` | ç§»åŠ¨å€¼ |
| `copy` | `/data copy <from> <to>` | å¤åˆ¶å€¼ |
| `calc` | `/data calc <path> "<expr>"` | å˜é‡è¿ç®— |
| `modify` | `/data modify <path> <action> <value>` | æ•°ç»„/å¯¹è±¡ä¿®æ”¹ |
| `test` | `/data test <path> <condition> [value]` | æ¡ä»¶æµ‹è¯• |

### å¤‡ç”¨æ ¼å¼ï¼šJSON å—

```xml
<UpdateVariable>
[
  {"op": "increment", "path": "è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦", "delta": 5},
  {"op": "add", "path": "èƒŒåŒ…/-", "value": "æ–°ç‰©å“"},
  {"op": "replace", "path": "è§’è‰².ç»œç»œ.çŠ¶æ€", "value": "å¼€å¿ƒ"}
]
</UpdateVariable>
```

### å‘åå…¼å®¹ï¼šå‡½æ•°è°ƒç”¨æ ¼å¼

```javascript
_.set('è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦', 50)
_.add('è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦', 5)
_.push('èƒŒåŒ…', 'æ–°ç‰©å“')
_.remove('ä¸´æ—¶æ ‡è®°')
```

## ğŸ“ æ¨¡æ¿è¯­æ³•

```handlebars
<!-- å˜é‡æ’å€¼ -->
{{è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦}}

<!-- æ¡ä»¶åˆ¤æ–­ -->
{{#if è§’è‰².ç»œç»œ.å¥½æ„Ÿåº¦ > 50}}
ç»œç»œå¯¹ä½ å¾ˆæœ‰å¥½æ„Ÿ
{{else}}
ç»œç»œå¯¹ä½ æ€åº¦ä¸€èˆ¬
{{/if}}

<!-- å¾ªç¯éå† -->
{{#each èƒŒåŒ… as item}}
- {{item}}
{{/each}}

<!-- å­˜åœ¨æ€§æ£€æŸ¥ -->
{{#if exists(è§’è‰².ç»œç»œ)}}
ç»œç»œåœ¨åœº
{{/if}}
```

## ğŸ—‚ï¸ æ•°æ®ç»“æ„

æ”¯æŒ `[å€¼, æè¿°]` æ ¼å¼çš„å˜é‡ï¼š

```json
{
  "è§’è‰²": {
    "ç»œç»œ": {
      "å¥½æ„Ÿåº¦": [50, "å¯¹ç©å®¶çš„å¥½æ„Ÿç¨‹åº¦ï¼ŒèŒƒå›´ 0-100"],
      "çŠ¶æ€": ["æ­£å¸¸", "å½“å‰çŠ¶æ€"]
    }
  }
}
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- [å˜é‡æ“ä½œè®¾è®¡æ–‡æ¡£](VARIABLE_OPERATIONS_DESIGN.md) - å®Œæ•´çš„è¯­æ³•è®¾è®¡å’Œç¤ºä¾‹

## âš ï¸ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨**è‡ªå®šä¹‰è®¸å¯è¯**ï¼ŒåŒ…å«ç‰¹å®šç¤¾åŒºé™åˆ¶æ¡æ¬¾ã€‚

è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“ è”ç³»

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åœ¨ GitHub ä¸Šæäº¤ Issueã€‚

## ğŸ™ é¸£è°¢

æœ¬é¡¹ç›®çš„å¼€å‘ç¦»ä¸å¼€ä»¥ä¸‹ä¼˜ç§€é¡¹ç›®çš„æ”¯æŒï¼š

| é¡¹ç›® | æè¿° |
|------|------|
| [SillyTavern](https://github.com/SillyTavern/SillyTavern) | å¼ºå¤§çš„ AI è§’è‰²æ‰®æ¼”å‰ç«¯å¹³å° |
| [TavernHelper](https://github.com/N0VI028/JS-Slash-Runner) | æä¾›æ‰©å±• API å’Œè„šæœ¬è¿è¡Œç¯å¢ƒ |
| [MVU å˜é‡æ¡†æ¶](https://github.com/MagicalAstrogy/MagVarUpdate) | å˜é‡æ›´æ–°è¯­æ³•æœºåˆ¶çš„è®¾è®¡å‚è€ƒ |
| [Minecraft](https://minecraft.net) | `/data` å‘½ä»¤è¯­æ³•è®¾è®¡çµæ„Ÿæ¥æº |
| [JSON Patch (RFC 6902)](https://jsonpatch.com/) | æ“ä½œç±»å‹å’Œæ‰¹é‡æ“ä½œè®¾è®¡å‚è€ƒ |

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œç¤¾åŒºæˆå‘˜çš„æ”¯æŒï¼